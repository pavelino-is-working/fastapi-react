{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\The Saga Continues\\\\PycharmProjects\\\\fastapi-react\\\\my-project\\\\src\\\\context\\\\ContextWrapper.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useReducer, useState } from \"react\";\nimport GlobalContext from \"./GlobalContext\";\nimport dayjs from \"dayjs\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction savedEventsReducer(state, _ref) {\n  let {\n    type,\n    payload,\n    token\n  } = _ref;\n  switch (type) {\n    case \"initialize\":\n      return payload;\n    case 'push':\n      saveAppointments(payload, token);\n      return [...state, payload];\n    case 'update':\n      return state.map(evt => evt.id === payload.id ? payload : evt);\n    case 'delete':\n      return state.filter(evt => evt.id !== payload.id);\n    default:\n      throw new Error();\n  }\n}\nasync function saveAppointments(payload, token) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    },\n    body: JSON.stringify(payload)\n  };\n  console.log(requestOptions);\n  const response = await fetch(\"/api/appointments\", requestOptions);\n  const data = await response.json();\n  console.log(data);\n}\nasync function updateAppointments(payload, token) {\n  const requestOptions = {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    },\n    body: JSON.stringify(payload)\n  };\n  console.log(requestOptions);\n  const response = await fetch(`/api/appointments/${payload.id}`, requestOptions);\n  const data = await response.json();\n  console.log(data);\n}\nasync function getAll(token) {\n  const requestOptions = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  };\n  const response = await fetch('/api/appointments', requestOptions);\n  const data = await response.json();\n  console.log(data);\n  return data;\n}\nexport default function ContextWrapper(props) {\n  _s();\n  const [monthIndex, setMonthIndex] = useState(dayjs().month());\n  const [showEventModal, setShowEventModal] = useState(false);\n  const [daySelected, setDaySelected] = useState(dayjs());\n  const [selectedEvent, setSelectedEvent] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem(\"awesomeCalendarToken\"));\n  const [savedEvents, dispatchCalEvent] = useReducer(savedEventsReducer, []);\n  useEffect(() => {\n    async function fetchData() {\n      const data = await getAll(token);\n      dispatchCalEvent({\n        type: \"initialize\",\n        payload: data\n      });\n    }\n    fetchData();\n  }, []);\n  useEffect(() => {\n    localStorage.setItem(\"savedEvents\", JSON.stringify(savedEvents));\n  }, [savedEvents]);\n  useEffect(() => {\n    if (!showEventModal) {\n      setSelectedEvent(null);\n    }\n  }, [showEventModal]);\n  useEffect(() => {\n    const fetchUser = async () => {\n      const requestOptions = {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + token\n        }\n      };\n      const response = await fetch(\"/api/users/me\", requestOptions);\n      if (!response.ok) {\n        setToken(null);\n      }\n      localStorage.setItem(\"awesomeCalendarToken\", token);\n    };\n    fetchUser();\n  }, [token]);\n  return /*#__PURE__*/_jsxDEV(GlobalContext.Provider, {\n    value: {\n      monthIndex,\n      setMonthIndex,\n      showEventModal,\n      setShowEventModal,\n      daySelected,\n      setDaySelected,\n      dispatchCalEvent,\n      savedEvents,\n      selectedEvent,\n      setSelectedEvent,\n      token,\n      setToken\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 9\n  }, this);\n}\n_s(ContextWrapper, \"RVWto/pYZvFiRFC3lqn0kQOwiGg=\");\n_c = ContextWrapper;\nvar _c;\n$RefreshReg$(_c, \"ContextWrapper\");","map":{"version":3,"names":["React","useEffect","useReducer","useState","GlobalContext","dayjs","jsxDEV","_jsxDEV","savedEventsReducer","state","_ref","type","payload","token","saveAppointments","map","evt","id","filter","Error","requestOptions","method","headers","body","JSON","stringify","console","log","response","fetch","data","json","updateAppointments","getAll","ContextWrapper","props","_s","monthIndex","setMonthIndex","month","showEventModal","setShowEventModal","daySelected","setDaySelected","selectedEvent","setSelectedEvent","setToken","localStorage","getItem","savedEvents","dispatchCalEvent","fetchData","setItem","fetchUser","Authorization","ok","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/The Saga Continues/PycharmProjects/fastapi-react/my-project/src/context/ContextWrapper.js"],"sourcesContent":["import React, { useEffect, useReducer, useState } from \"react\";\r\nimport GlobalContext from \"./GlobalContext\";\r\nimport dayjs from \"dayjs\";\r\n\r\nfunction savedEventsReducer(state, {type, payload, token}){\r\n    \r\n    switch(type){\r\n        case \"initialize\":\r\n            return payload;\r\n        case 'push':\r\n            saveAppointments(payload, token)\r\n            return[...state, payload];\r\n        case 'update':\r\n            return state.map((evt) => evt.id === payload.id ? payload : evt);\r\n        case 'delete':\r\n            return state.filter((evt) => evt.id !== payload.id);\r\n        default:\r\n            throw new Error();\r\n    }\r\n}\r\nasync function saveAppointments(payload, token) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\"Content-Type\": \"application/json\",\r\n                   \"Authorization\": \"Bearer \" + token},\r\n        body: JSON.stringify(payload),    \r\n    };\r\n    console.log(requestOptions)\r\n    const response = await fetch(\"/api/appointments\", requestOptions);\r\n    const data = await response.json();\r\n    console.log(data)\r\n}\r\n\r\nasync function updateAppointments(payload, token) {\r\n    const requestOptions = {\r\n        method: \"PUT\",\r\n        headers: {\"Content-Type\": \"application/json\",\r\n                   \"Authorization\": \"Bearer \" + token},\r\n        body: JSON.stringify(payload),    \r\n    };\r\n    console.log(requestOptions)\r\n    const response = await fetch(`/api/appointments/${payload.id}`, requestOptions);\r\n    const data = await response.json();\r\n    console.log(data)\r\n}\r\n\r\nasync function getAll(token){\r\n    const requestOptions = {\r\n        method: \"GET\",\r\n        headers: {\"Content-Type\": \"application/json\",\r\n                   \"Authorization\": \"Bearer \" + token},  \r\n    };\r\n    const response = await fetch('/api/appointments', requestOptions);\r\n    const data = await response.json();\r\n    console.log(data)\r\n    return data;   \r\n}\r\n\r\n\r\nexport default function ContextWrapper(props){\r\n    \r\n    const[monthIndex, setMonthIndex] = useState(dayjs().month());\r\n    const[showEventModal,setShowEventModal ] = useState(false);\r\n    const[daySelected, setDaySelected ] = useState(dayjs());\r\n    const[selectedEvent,setSelectedEvent ] = useState(null);\r\n    const [token, setToken] = useState(localStorage.getItem(\"awesomeCalendarToken\"));\r\n    const [savedEvents, dispatchCalEvent] = useReducer(savedEventsReducer, []);\r\n\r\n    useEffect(() => {\r\n        async function fetchData() {\r\n          const data = await getAll(token);\r\n          dispatchCalEvent({ type: \"initialize\", payload: data });\r\n        }\r\n        fetchData();\r\n      }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem(\"savedEvents\", JSON.stringify(savedEvents));\r\n    }, [savedEvents]);\r\n\r\n\r\n    \r\n    useEffect(() => {\r\n        if (!showEventModal) {\r\n          setSelectedEvent(null);\r\n        }\r\n      }, [showEventModal]);\r\n\r\n      useEffect(() => {\r\n        const fetchUser = async () =>{\r\n           const requestOptions = {\r\n               method: \"GET\",\r\n               headers:{\r\n                   \"Content-Type\": \"application/json\",\r\n                   Authorization: \"Bearer \" + token,\r\n               },\r\n           };\r\n           const response = await fetch(\"/api/users/me\", requestOptions);\r\n           if (!response.ok){\r\n           setToken(null);\r\n            }\r\n            localStorage.setItem(\"awesomeCalendarToken\", token);\r\n        };\r\n        fetchUser();\r\n       }, [token]);\r\n\r\n    return (\r\n        <GlobalContext.Provider value={{ \r\n            monthIndex, \r\n            setMonthIndex,\r\n            showEventModal,\r\n            setShowEventModal,\r\n            daySelected,\r\n            setDaySelected,\r\n            dispatchCalEvent,\r\n            savedEvents,\r\n            selectedEvent,\r\n            setSelectedEvent,\r\n            token,\r\n            setToken,\r\n            }}>\r\n            {props.children}\r\n        </GlobalContext.Provider>\r\n    );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}